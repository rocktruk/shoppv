<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<meta name="format-detection" content="telephone=no"/>
<meta name="viewport" content="user-scalable=no, width=device-width, initial-scale=1.0, maximum-scale=1.0"/>
<title>龙鑫商城</title>
<link type="text/css" rel="stylesheet" th:href="@{css/shopcar/base.css}" />
<link type="text/css" rel="stylesheet" th:href="@{css/shopcar/module.css}"  />
</head>

<body>
<!--头部开始-->
<div class="header">
	<h1>购物车</h1>
	<a href="javascript:;" onclick="editor()" style="right:10px">编辑</a>
</div>
<!--头部结束-->
<div class="shopping">
	
	<div class="shop-group-item">
		<div class="shop-name"> 
			<input type="checkbox" style="display:none" class="check goods-check shopCheck">
			<!--<h4><a href="#">苹果专卖店</a></h4>
			<div class="coupons"><span>领券</span><em>|</em><span>编辑</span><span class="shop-total-amount ShopTotal">0</span></div>-->
		</div>
		<ul>
			<li th:each="merchandise:${data.goods}">
				<div class="shop-info">
					<input type="checkbox" class="check goods-check goodsCheck" style="border: none">
					<h5 style="display:none" th:text="${merchandise.id}"></h5>
					<div class="shop-info-img"><a th:href="@{goodsInfo(goodsId=${merchandise.goods.id})}"><img th:src="@{${merchandise.goods.imgPath}}" /></a></div>
					<div class="shop-info-text">
						<h4 th:text="${merchandise.goods.title}"></h4>
						<div class="shop-brief"><span>运费:<i class="carriage" th:text="${merchandise.goods.carriage}"></i></span></div>
						<div class="shop-price">
							<div class="shop-pices">￥<b class="price" th:text="${merchandise.goods.price}"></b></div>
							<div class="shop-arithmetic">
								<a href="javascript:;" class="minus">-</a>
								<span class="num" th:text="${merchandise.count}"></span>
								<a href="javascript:;" class="plus">+</a>
							</div>
						</div>
					</div>
				</div>
			</li>
		</ul>
	</div>
	
<!-- 	<div class="shop-group-item"> -->
<!-- 		<div class="shop-name"> -->
<!-- 			<input type="checkbox" class="check goods-check shopCheck"> -->
<!-- 			<h4><a href="#">苹果专卖店</a></h4> -->
<!-- 			<div class="coupons"><span>领券</span><em>|</em><span>编辑</span><span class="shop-total-amount ShopTotal">0</span></div> -->
<!-- 		</div> -->
<!-- 		<ul> -->
<!-- 			<li> -->
<!-- 				<div class="shop-info"> -->
<!-- 					<input type="checkbox" class="check goods-check goodsCheck"> -->
<!-- 					<h5>SHOP918273</h5> -->
<!-- 					<div class="shop-info-img"><a href="#"><img th:src="@{images/shopcar/computer.jpg}" /></a></div> -->
<!-- 					<div class="shop-info-text"> -->
<!-- 						<h4>Apple MacBook Pro 13.3英寸笔记本电脑 银色(Core i5 处理器/8GB内存/128GB SSD闪存/Retina屏 MF839CH/A)</h4> -->
<!-- 						<div class="shop-brief"><span>重量:3.3kg</span><span>颜色:标配版</span><span>版本:13.3英寸</span></div> -->
<!-- 						<div class="shop-price"> -->
<!-- 							<div class="shop-pices">￥<b class="price">100.00</b></div> -->
<!-- 							<div class="shop-arithmetic"> -->
<!-- 								<a href="javascript:;" class="minus">-</a> -->
<!-- 								<span class="num" >1</span> -->
<!-- 								<a href="javascript:;" class="plus">+</a> -->
<!-- 							</div> -->
<!-- 						</div> -->
<!-- 					</div> -->
<!-- 				</div> -->
<!-- 			</li> -->
<!-- 			<li> -->
<!-- 				<div class="shop-info"> -->
<!-- 					<input type="checkbox" class="check goods-check goodsCheck"> -->
<!-- 					<div class="shop-info-img"><a href="#"><img th:src="@{images/shopcar/computer.jpg}" /></a></div> -->
<!-- 					<div class="shop-info-text"> -->
<!-- 						<h4>Apple MacBook Pro 13.3英寸笔记本电脑 银色(Core i5 处理器/8GB内存/128GB SSD闪存/Retina屏 MF839CH/A)</h4> -->
<!-- 						<div class="shop-brief"><span>重量:3.3kg</span><span>颜色:标配版</span><span>版本:13.3英寸</span></div> -->
<!-- 						<div class="shop-price"> -->
<!-- 							<div class="shop-pices">￥<b class="price">100.00</b></div> -->
<!-- 							<div class="shop-arithmetic"> -->
<!-- 								<a href="javascript:;" class="minus">-</a> -->
<!-- 								<span class="num" >1</span> -->
<!-- 								<a href="javascript:;" class="plus">+</a> -->
<!-- 							</div> -->
<!-- 						</div> -->
<!-- 					</div> -->
<!-- 				</div> -->
<!-- 			</li> -->
<!-- 		</ul> -->
<!-- 		<div class="shopPrice">本店总计：￥<span class="shop-total-amount ShopTotal">0.00</span></div> -->
<!-- 	</div> -->
</div>
<div class="payment-bar">
	<div class="all-checkbox"><input type="checkbox" class="check goods-check" style="border: none" id="AllCheck">全选</div>
	<div class="shop-total">
		<strong>总价：<i class="total" id="AllTotal">0.00</i></strong>
		<span>减免：0</span>
	</div>
	<a href="javascript:;" class="settlement" onclick="submit()">结算</a>
	<span style="display:none" id="ids"></span>
	<a th:href="@{fillOrder}" id="settlea" style="display:none"><span id="settle">结算</span></a>
</div>
<div class="del-bar" style="display:none">
	<div class="all-checkbox"><input type="checkbox" class="check goods-check" id="delCheck">全选</div>
	<a href="javascript:;" class="delete" onclick="delShopCar()">删除</a>
</div>
<script type="text/javascript" th:src="@{js/list/jquery-3.2.1.min.js}"></script>
<script type="text/javascript" th:src="@{js/shopcar/shopping.js}"></script>
<script type="text/javascript">
	var editStat = "settle";
	function editor(){
		if(editStat == "settle"){
			$(".payment-bar").css("display",'none');
			$(".del-bar").css("display",'block');
			editStat = "del";
		}else{
			$(".payment-bar").css("display",'block');
			$(".del-bar").css("display",'none');
			editStat = "settle";
		}
	}

	function delShopCar(){
		$.ajax({
			data: JSON.stringify({"ids":$("#ids").text()}),
			url:  "delCarGoods",
			type: "POST",
			contentType:"application/json",
			success:function(data){
				if(data.respcode=="000000"){
					window.location.reload();
				}else{
					alert(data.respmsg);
				}
			},
			error:function(msg)
			{
				console.log(msg);
			}
		});
	}

	function submit(){
		if(!$("#ids").text()||$("#ids").text()==""){
			alert("请先选择结算商品");
			return;
		}
		$.ajax({
			data: JSON.stringify({"ids":$("#ids").text()}),
			url:  "orderSubmit",
			type: "POST",
			contentType:"application/json",
			success:function(data){
				if(data.respcode=="000000"){
					$("#settlea").attr("href","fillOrder?orderId="+data.orderId);
					$("#settle").click();
				}else{
				    alert(data.respmsg);
				}
			},
			error:function(msg)
			{
				console.log(msg);
			}
		});
	}
	
</script>
</body>
</html>
